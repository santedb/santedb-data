/** 
 * <feature scope="SanteDB.Persistence.Data" id="20240320" name="Update:20240320"  invariantName="sqlite">
 *	<summary>Update:Adds central configuration for LOCAL_USERS and LOCAL_ADMINISTRATORS</summary>
 *  <isInstalled>SELECT EXISTS (SELECT 1 FROM sec_rol_tbl WHERE rol_name='LOCAL_ADMINISTRATORS')</isInstalled>
 * </feature>
 */
INSERT INTO SEC_ROL_TBL (ROL_ID, ROL_NAME, DESCR, CRT_PROV_ID) VALUES (x'E06B606799CBFB4C86588D0C006116AC', 'LOCAL_ADMINISTRATORS', 'Group for administrators which have control over local functions', x'76A0DCFA90366E4AAF9EF1CD68E8C7E8');
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES (x'AA91A80E4D22594881B3C1EB2750067E', x'E06B606799CBFB4C86588D0C006116AC', 2); -- GRANT Local Administrative Function
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES (x'FE965BF46C64004C9A58EA09EEE67DAD', x'E06B606799CBFB4C86588D0C006116AC', 2); -- GRANT Create Local Users
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES (x'FF965BF46C64004C9A58EA09EEE67DAD', x'E06B606799CBFB4C86588D0C006116AC', 2); -- GRANT Alter Local Users

-- HACK: INSERT PLACEHOLDER POLICIES IF NONE EXIST
INSERT INTO SEC_POL_TBL (POL_ID, OID, POL_NAME, IS_PUB, IS_ELEV, CRT_PROV_ID) VALUES (x'9CFE49B72A45364DA50DB7C04BF346E4','1.3.6.1.4.1.33349.3.1.5.9.2.0.22.0','Read System Jobs',TRUE,FALSE,x'76A0DCFA90366E4AAF9EF1CD68E8C7E8') ON CONFLICT DO NOTHING;
INSERT INTO SEC_POL_TBL (POL_ID, OID, POL_NAME, IS_PUB, IS_ELEV, CRT_PROV_ID) VALUES (x'9CFE49C72A45364DA50DB7C04BF346E4','1.3.6.1.4.1.33349.3.1.5.9.2.0.22.1','Start/Run System Job',TRUE,FALSE,x'76A0DCFA90366E4AAF9EF1CD68E8C7E8') ON CONFLICT DO NOTHING; 

INSERT INTO SEC_ROL_TBL (ROL_ID, ROL_NAME, DESCR, CRT_PROV_ID) VALUES (x'1DD516B91844C84A960D380CADD8C0C7', 'LOCAL_USERS', 'Group for local users (only allowed to log into the device on which they are created)', x'76A0DCFA90366E4AAF9EF1CD68E8C7E8');
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES (x'9CFE49B72A45364DA50DB7C04BF346E4', x'1DD516B91844C84A960D380CADD8C0C7', 2); -- GRANT Read Local Jobs
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES (x'9CFE49C72A45364DA50DB7C04BF346E4', x'1DD516B91844C84A960D380CADD8C0C7', 2); -- GRANT Start Local Job
