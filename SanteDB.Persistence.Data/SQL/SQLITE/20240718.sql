/** 
 * <feature scope="SanteDB.Persistence.Data" id="20240718-01" name="Update:20240718-01" invariantName="sqlite">
 *	<summary>Update: Fixes the entity relationship trigger and adds new relationship validations</summary>
 *	<isInstalled>select count(*) > 0 from patch_db_systbl WHERE PATCH_ID = '20240718-01'</isInstalled>
 * </feature>
 */

INSERT INTO REL_VRFY_SYSTBL (REL_TYP_CD_ID, SRC_CLS_CD_ID, TRG_CLS_CD_ID, ERR_DESC) 
    VALUES (x'D373624F2382184E8596C718AD029DEB',x'A7DF34FFD3C68B4FBC9F14BCDC13BA6C',x'24F36FB774B1B740A6ACD1FDF8E23967', 'ServiceDeliveryLocation=[LocatedEntity]=>Container') ON CONFLICT DO NOTHING;
INSERT INTO REL_VRFY_SYSTBL (REL_TYP_CD_ID, SRC_CLS_CD_ID, TRG_CLS_CD_ID, ERR_DESC) 
    VALUES (x'21A6029C6585B44694FFA2BD210989B1',x'A7DF34FFD3C68B4FBC9F14BCDC13BA6C',x'24F36FB774B1B740A6ACD1FDF8E23967', 'ServiceDeliveryLocation=[HeldEntity]=>Container') ON CONFLICT DO NOTHING;
INSERT INTO REL_VRFY_SYSTBL (REL_TYP_CD_ID, SRC_CLS_CD_ID, TRG_CLS_CD_ID, ERR_DESC) 
    VALUES (x'21A6029C6585B44694FFA2BD210989B1',x'24F36FB774B1B740A6ACD1FDF8E23967',x'86C2FEFAD5890B429085054ACA9D1EEF', 'Container=[HeldEntity]=>ManufacturedMaterial') ON CONFLICT DO NOTHING;
INSERT INTO REL_VRFY_SYSTBL (REL_TYP_CD_ID, SRC_CLS_CD_ID, TRG_CLS_CD_ID, ERR_DESC) 
    VALUES (x'CDD8B677A0051F4B9E14B895203BF40C',x'BA002B6A1B502345B57CF96D8AE44684',x'A7DF34FFD3C68B4FBC9F14BCDC13BA6C', 'UserEntity=[MaintainedEntity]=>ServiceDeliveryLocation') ON CONFLICT DO NOTHING;
INSERT INTO REL_VRFY_SYSTBL (REL_TYP_CD_ID, SRC_CLS_CD_ID, TRG_CLS_CD_ID, ERR_DESC) 
    VALUES (x'CDD8B677A0051F4B9E14B895203BF40C',x'55BD087C424DCD4992F86388D6C4183F',x'A7DF34FFD3C68B4FBC9F14BCDC13BA6C', 'Organization=[MaintainedEntity]=>ServiceDeliveryLocation') ON CONFLICT DO NOTHING;

INSERT INTO PATCH_DB_SYSTBL (PATCH_ID, APPLY_DATE, INFO_NAME) VALUES ('20240718-01', UNIXEPOCH(), 'Added extended Relationships'); 
