/** 
 * <feature scope="SanteDB.Persistence.Data" id="20240320-02" name="Update:20240320-02" environment="Server"  invariantName="npgsql">
 *	<summary>Update: Adds central configuration for LOCAL_USERS and LOCAL_ADMINISTRATORS</summary>
 *	<isInstalled>select ck_patch('20240320-02')</isInstalled>
 * </feature>
 */
INSERT INTO SEC_ROL_TBL (ROL_ID, ROL_NAME, DESCR, CRT_PROV_ID) VALUES ('67606BE0-CB99-4CFB-8658-8D0C006116AC', 'LOCAL_ADMINISTRATORS', 'Group for administrators which have control over local functions', 'fadca076-3690-4a6e-af9e-f1cd68e8c7e8') ON CONFLICT DO NOTHING;
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES ('0ea891aa-224d-4859-81b3-c1eb2750067e', '67606BE0-CB99-4CFB-8658-8D0C006116AC', 2) ON CONFLICT DO NOTHING; -- GRANT Local Administrative Function
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES ('f45b96fe-646c-4c00-9a58-ea09eee67dad', '67606BE0-CB99-4CFB-8658-8D0C006116AC', 2) ON CONFLICT DO NOTHING; -- GRANT Create Local Users
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES ('f45b96ff-646c-4c00-9a58-ea09eee67dad', '67606BE0-CB99-4CFB-8658-8D0C006116AC', 2) ON CONFLICT DO NOTHING; -- GRANT Alter Local Users

-- HACK: INSERT PLACEHOLDER POLICIES IF NONE EXIST
INSERT INTO SEC_POL_TBL (POL_ID, OID, POL_NAME, IS_PUB, IS_ELEV, CRT_PROV_ID) VALUES ('B749FE9C-452A-4D36-A50D-B7C04BF346E4','1.3.6.1.4.1.33349.3.1.5.9.2.0.22.0','Read System Jobs',TRUE,FALSE,'fadca076-3690-4a6e-af9e-f1cd68e8c7e8') ON CONFLICT DO NOTHING;
INSERT INTO SEC_POL_TBL (POL_ID, OID, POL_NAME, IS_PUB, IS_ELEV, CRT_PROV_ID) VALUES ('C749FE9C-452A-4D36-A50D-B7C04BF346E4','1.3.6.1.4.1.33349.3.1.5.9.2.0.22.1','Start/Run System Job',TRUE,FALSE,'fadca076-3690-4a6e-af9e-f1cd68e8c7e8') ON CONFLICT DO NOTHING; 

INSERT INTO SEC_ROL_TBL (ROL_ID, ROL_NAME, DESCR, CRT_PROV_ID) VALUES ('B916D51D-4418-4AC8-960D-380CADD8C0C7', 'LOCAL_USERS', 'Group for local users (only allowed to log into the device on which they are created)', 'fadca076-3690-4a6e-af9e-f1cd68e8c7e8') ON CONFLICT DO NOTHING;
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES ('B749FE9C-452A-4D36-A50D-B7C04BF346E4', 'B916D51D-4418-4AC8-960D-380CADD8C0C7', 2) ON CONFLICT DO NOTHING; -- GRANT Read Local Jobs
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES ('C749FE9C-452A-4D36-A50D-B7C04BF346E4', 'B916D51D-4418-4AC8-960D-380CADD8C0C7', 2) ON CONFLICT DO NOTHING; -- GRANT Start Local Job

-- GRANT READ LOCAL JOBS TO CLINICAL_STAFF
INSERT INTO SEC_ROL_POL_ASSOC_TBL (POL_ID, ROL_ID, POL_ACT)  VALUES ('B749FE9C-452A-4D36-A50D-B7C04BF346E4', '43167dcb-6f77-4f37-8222-133e675b4434', 2) ON CONFLICT DO NOTHING; -- GRANT Read Local Jobs

 SELECT REG_PATCH('20240320-02'); 
